!function(t){var e={};function a(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=t,a.c=e,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)a.d(n,r,function(e){return t[e]}.bind(null,r));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/",a(a.s=2)}([,,function(t,e,a){t.exports=a(3)},function(t,e){$(document).ajaxStart((function(){$("#loading").show()})).ajaxStop((function(){$("#loading").hide()})),$(document).ready((function(){function t(){this.initData={},this.objJson={},this.current_page=1,this.records_per_page=15;this.init=function(t){this.initData=t;var e=Object.keys(t).map((function(e){return[Number(e),t[e]]}));this.objJson=e.sort((function(t,e){var a=t[0].updated_at,n=e[0].updated_at;return new Date(a)>new Date(n)?1:-1})),console.log(this.objJson),this.createPanigation(),this.changePage(1),$("#select-all").on("click",this.selectAll.bind(this))},this.selectAll=function(t){$(".selected_item").prop("checked",t.target.checked),this.objJson.forEach((function(e,a){e[1].selected=t.target.checked}))},this.selectItem=function(t){var e=$(t.target).attr("data-no");this.objJson[e][1].selected=t.target.checked},this.prevPage=function(){this.current_page>1&&(this.current_page--,this.changePage(this.current_page))},this.nextPage=function(){this.current_page<this.numPages()&&(this.current_page++,this.changePage(this.current_page))},this.changePage=function(t){var e=document.getElementById("btn_prev"),a=document.getElementById("btn_next"),n=document.getElementById("listingTable"),r=document.getElementById("page");t<1&&(t=1),t>this.numPages()&&(t=this.numPages()),this.current_page=t,n.innerHTML="";for(var o=(t-1)*this.records_per_page;o<t*this.records_per_page;o++)this.objJson[o]&&(n.innerHTML+=this.createEL(this.objJson[o][1],o+1,!0));if(r.innerHTML=t+"/"+this.numPages(),1==t?e.classList.add("disabled"):e.classList.remove("disabled"),t==this.numPages()?a.classList.add("disabled"):a.classList.remove("disabled"),$(".page-number.active").removeClass("active"),$("[data-page="+t+"]").parent().addClass("active"),$(".selected_item").on("click",this.selectItem.bind(this)),this.numPages()>10){var i=0,s=0;this.numPages()-Number(t)<Number(5)?i=Number(t)-2*Number(5)+(this.numPages()-Number(t)):(i=Number(t)-Number(5))<1&&(i=1),Number(t)-Number(i)<Number(5)?s=Number(t)+2*Number(5)-(Number(t)-Number(i)):(s=Number(t)+Number(5))>this.numPages()&&(s=this.numPages()),$(".page-number").addClass("hide-item");for(var c=i;c<=s;c++)$("[data-page="+c+"]").parent().removeClass("hide-item"),$("[data-page="+c+"]").text($("[data-page="+c+"]").attr("data-page"));$("[data-page="+Number(i-1)+"]").parent().removeClass("hide-item"),$("[data-page="+Number(i-1)+"]").text("..."),$("[data-page="+Number(s+1)+"]").parent().removeClass("hide-item"),$("[data-page="+Number(s+1)+"]").text("...")}},this.numPages=function(){return Math.ceil(this.objJson.length/this.records_per_page)},this.reconciliation=function(){for(var t=[],e=!1,a=0;a<this.objJson.length;a++)this.objJson[a][1].selected&&(e=!0),this.objJson[a][1].selected&&1==this.objJson[a][1].confirmed&&2==this.objJson[a][1].status&&t.push(this.objJson[a][1].id);console.log(t),t.length>0?$.ajax({type:"POST",url:createReconciliationUrl,data:{selectedIds:t,_token:n},success:function(t){console.log(t),200==t.status?(console.log(t.data),$("#successModal").find(".msg_success").text(t.message),$("#successModal").show()):($("#errorModal").find(".msg_error").text(t.message),$("#errorModal").show())},error:function(t,e){var a="";a=0===t.status?"Not connect.\n Verify Network.":404==t.status?"Requested page not found. [404]":500==t.status?"Internal Server Error [500].":"parsererror"===e?"Requested JSON parse failed.":"timeout"===e?"Time out error.":"abort"===e?"Ajax request aborted.":"Uncaught Error.\n"+t.responseText,$("#errorModal").find(".msg_error").text(a),$("#errorModal").show()}}):(e?$("#errorModal").find(".msg_error").text("Giao dịch chọn đã được đối soát trước đó hoặc chưa được thanh toán"):$("#errorModal").find(".msg_error").text("Chưa có giao dịch nào được chọn"),$("#errorModal").show())},this.exportExcel=function(){for(var t="",e=1,a=0;a<this.objJson.length;a++)this.objJson[a][1].selected&&(t+="<tr>"+this.createEL(this.objJson[a][1],e,!0)+"</tr>",e++);var n=$("#clone-object").clone();n.find("#listingTable").html($.parseHTML(t)),n.find("th:last-child, td:last-child").hide(),n.table2excel({exclude:".no-export",name:"Worksheet Name",filename:"transactions.xls",preserveColors:!1})},this.printData=function(){for(var t="",e=1,a=0;a<this.objJson.length;a++)this.objJson[a][1].selected&&(t+="<tr>"+this.createEL(this.objJson[a][1],e,!0)+"</tr>",e++);var n=$("#clone-object").clone();n.find("#listingTable").html($.parseHTML(t)),n.removeAttr("hidden"),n.find("th:last-child, td:last-child").hide();var r=window.open();r.document.write(n.prop("outerHTML")),r.print(),r.close()},this.createEL=function(t,e){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=$("#transaction-item").clone();return n.attr("id","transaction-"+t.id),n.attr("data-id",t.id),n.find("[data-attr='selected_item']").val(t.id),a?n.find("[data-attr='transaction_no']").text(e):n.find("[data-attr='selected_item']").attr("data-no",e),t.selected?n.find("[data-attr='selected_item']").attr("checked",!0):n.find("[data-attr='selected_item']").attr("checked",!1),n.find("[data-attr='transactionId']").text(t.transactionId),n.find("[data-attr='paid_amount']").text(this.fomatNumber(t.paid_amount)),n.find("[data-attr='name']").text(t.name),n.find("[data-attr='contract_code_disbursement']").text(t.contract_code_disbursement),n.find("[data-attr='paid_date']").text(t.paid_date),n.find("[data-attr='payment_option']").text(t.payment_option),1==t.payment_option?n.find("[data-attr='payment_option']").text("Thanh toán kỳ"):2==t.payment_option?n.find("[data-attr='payment_option']").text("Tất toán"):3==t.payment_option?n.find("[data-attr='payment_option']").text("NĐT"):n.find("[data-attr='payment_option']").text(""),n.find("[data-attr='transaction_fee']").text(this.fomatNumber(t.transaction_fee)),1==t.payment_option||2==t.payment_option?1==t.contract_status?n.find("[data-attr='contract_status']").text("Đang xử lý"):2==t.contract_status?n.find("[data-attr='contract_status']").text("Đã trừ tiền kỳ"):n.find("[data-attr='contract_status']").text("Thất bại"):n.find("[data-attr='contract_status']").text(""),1==t.status?n.find("[data-attr='status']").text("Chưa thanh toán"):2==t.status?n.find("[data-attr='status']").text("Đã thanh toán"):n.find("[data-attr='status']").text("Unknown"),1==t.confirmed?n.find("[data-attr='confirmed']").text("Chưa đối soát"):2==t.confirmed?n.find("[data-attr='confirmed']").text("Đã đối soát"):n.find("[data-attr='confirmed']").text("Unknown"),n.find("#details-show-info__id__").attr("data-id",t.id),n.find("#details-show-info__id__").attr("href","/cpanel/momo/transaction/"+t.id),n.html()},this.createPanigation=function(){$("li.page-number").remove();for(var t=1;t<=this.numPages();t++)1==t?$("<li class='page-item page-number active'><a class='page-link' data-page='"+t+"' href='javascript:void(0);'>"+t+"</a></li>").insertBefore("#btn_next"):$("<li class='page-item page-number'><a class='page-link' data-page='"+t+"' href='javascript:void(0);'>"+t+"</a></li>").insertBefore("#btn_next")},this.fomatNumber=function(t){return(new Intl.NumberFormat).format(t)}}var e,a=new t,n=$('[name="_token"]').val();e=transactions,a&&(a=null),a=new t,console.log("initPage ",e),a.init(e),$("#btn_prev").click((function(){a.prevPage()})),$("#btn_next").click((function(){a.nextPage()})),$(".pagination").on("click",".page-number",(function(){var t=event.target;a.changePage($(t).attr("data-page"))})),$(".close").on("click",(function(t){$("#errorModal").hide()})),$("#cancel").on("click",(function(t){t.preventDefault();var e={id:reconciliationId,_token:n};$.ajax({type:"POST",url:deleteUrl,data:e,success:function(t){console.log(t),200==t.status?($("#action-group").html('<button style="color: #000000;" type="button" class="btn" disabled="disabled">Đã Huỷ</button>'),$("#successModal").find(".msg_error").text(t.message),$("#successModal").show()):($("#errorModal").find(".msg_error").text(t.message),$("#errorModal").show())},error:function(t,e){var a="";a=0===t.status?"Not connect.\n Verify Network.":404==t.status?"Requested page not found. [404]":500==t.status?"Internal Server Error [500].":"parsererror"===e?"Requested JSON parse failed.":"timeout"===e?"Time out error.":"abort"===e?"Ajax request aborted.":"Uncaught Error.\n"+t.responseText,$("#errorModal").find(".msg_error").text(a),$("#errorModal").show()}})})),$("#send-email").on("click",(function(t){t.preventDefault();var e={id:reconciliationId,_token:n};$.ajax({type:"POST",url:sendEmail,data:e,success:function(t){console.log(t),200==t.status?($("#action-group").html('<button style="color: #000000;" type="button" class="btn" disabled="disabled">Đã Gửi Email</button>'),$("#successModal").find(".msg_success").text(t.message),$("#successModal").show()):($("#errorModal").find(".msg_error").text(t.message),$("#errorModal").show())},error:function(t,e){var a="";a=0===t.status?"Not connect.\n Verify Network.":404==t.status?"Requested page not found. [404]":500==t.status?"Internal Server Error [500].":"parsererror"===e?"Requested JSON parse failed.":"timeout"===e?"Time out error.":"abort"===e?"Ajax request aborted.":"Uncaught Error.\n"+t.responseText,$("#errorModal").find(".msg_error").text(a),$("#errorModal").show()}})})),$("#print-data").on("click",(function(t){t.preventDefault(),a.printData()})),$("#export-excel").on("click",(function(t){t.preventDefault(),a.exportExcel()})),$("#reconciliation-data").on("click",(function(t){t.preventDefault(),$("#modal-confirm").show()})),$("#cancel").on("click",(function(t){t.preventDefault(),$("#modal-confirm").hide()})),$("#create-reconciliation").on("click",(function(t){t.preventDefault(),$("#modal-confirm").hide(),a.reconciliation()}))}))}]);
