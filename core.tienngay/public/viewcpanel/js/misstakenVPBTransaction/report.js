!function(e){var t={};function a(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/",a(a.s=20)}({20:function(e,t,a){e.exports=a(21)},21:function(e,t){$(document).ajaxStart((function(){$("#loading").show();var e=window.screen.height;$("#loading, .right-col iframe").css("height",e)})).ajaxStop((function(){$("#loading").hide()})),$(document).ready((function(){function e(){this.initData={},this.objJson={},this.current_page=1,this.records_per_page=25,this.selectedIds=[];this.init=function(e){this.initData=e;var t=Object.keys(e).map((function(t){return[Number(t),e[t]]}));this.objJson=t.sort((function(e,t){var a=new Date(e[1].transactionDate),n=new Date(t[1].transactionDate);return new Date(a)>new Date(n)?-1:1})),this.createPanigation(),this.changePage(1),$("#select-all").off().on("click",this.selectAll.bind(this)),$("#export-excel").off().on("click",this.exportExcel.bind(this)),$("#print-data").off().on("click",this.printData.bind(this)),document.getElementById("total").innerHTML=fomatNumber(this.objJson.length)},this.selectAll=function(e){var t=[];$(".selected_item").prop("checked",e.target.checked),this.objJson.forEach((function(a,n){a[1].selected=e.target.checked,e.target.checked&&t.push(a[1].id)})),this.selectedIds=t},this.selectItem=function(e){var t=$(e.target).attr("data-no");if(this.objJson[t][1].selected=e.target.checked,e.target.checked&&-1===this.selectedIds.indexOf(this.objJson[t][1].id))this.selectedIds.push(this.objJson[t][1].id);else{var a=this.selectedIds.indexOf(this.objJson[t][1].id);a>-1&&this.selectedIds.splice(a,1)}},this.numPages=function(){return Math.ceil(this.objJson.length/this.records_per_page)},this.prevPage=function(){this.current_page>1&&(this.current_page--,this.changePage(this.current_page))},this.nextPage=function(){this.current_page<this.numPages()&&(this.current_page++,this.changePage(this.current_page))},this.changePageAction=function(e){var t=$(e.target).attr("data-page");this.changePage(t)},this.changePage=function(e){var t=document.getElementById("btn_prev"),a=document.getElementById("btn_next"),n=document.getElementById("listingTable"),r=document.getElementById("page");e<1&&(e=1),e>this.numPages()&&(e=this.numPages()),this.current_page=e,n.innerHTML="";for(var i=(e-1)*this.records_per_page;i<e*this.records_per_page;i++)this.objJson[i]&&(n.innerHTML+=this.createEL(this.objJson[i][1],i));if(r.innerHTML=e+"/"+this.numPages(),1==e?t.classList.add("disabled"):t.classList.remove("disabled"),e==this.numPages()?a.classList.add("disabled"):a.classList.remove("disabled"),$(".page-number.active").removeClass("active"),$("[data-page="+e+"]").parent().addClass("active"),$(".selected_item").on("click",this.selectItem.bind(this)),this.numPages()>10){var s=0,o=0;this.numPages()-Number(e)<Number(5)?s=Number(e)-2*Number(5)+(this.numPages()-Number(e)):(s=Number(e)-Number(5))<1&&(s=1),Number(e)-Number(s)<Number(5)?o=Number(e)+2*Number(5)-(Number(e)-Number(s)):(o=Number(e)+Number(5))>this.numPages()&&(o=this.numPages()),$(".page-number").addClass("hide-item");for(var c=s;c<=o;c++)$("[data-page="+c+"]").parent().removeClass("hide-item"),$("[data-page="+c+"]").text($("[data-page="+c+"]").attr("data-page"));$("[data-page="+Number(s-1)+"]").parent().removeClass("hide-item"),$("[data-page="+Number(s-1)+"]").text("..."),$("[data-page="+Number(o+1)+"]").parent().removeClass("hide-item"),$("[data-page="+Number(o+1)+"]").text("...")}},this.numPages=function(){return Math.ceil(this.objJson.length/this.records_per_page)},this.createPanigation=function(){$("li.page-number").remove();for(var e=1;e<=this.numPages();e++)1==e?$("<li class='page-item page-number active'><a class='page-link' data-page='"+e+"' href='javascript:void(0);'>"+e+"</a></li>").insertBefore("#btn_next"):$("<li class='page-item page-number'><a class='page-link' data-page='"+e+"' href='javascript:void(0);'>"+e+"</a></li>").insertBefore("#btn_next");$("#btn_prev").off().on("click",this.prevPage.bind(this)),$("#btn_next").off().on("click",this.nextPage.bind(this)),$(".pagination").off().on("click",".page-number",this.changePageAction.bind(this))},this.createEL=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"clone-object",r=$("#"+n).find("#clone-item").clone(),i=r.find("td");return $.each(i,(function(t,n){var r=$(i[t]).attr("data-attr");if(r){var s=r.split("."),o=null;if(s.length>1){o=e;for(var c=0;c<s.length;c++){if(!(s[c]in o))return;o=o[s[c]]}}else{if(!(r in e))return;o=e[r]}if($(i[t]).attr("format-number"))_numberFormated=fomatNumber(o),$(i[t]).text(_numberFormated);else if($(i[t]).attr("zero-before")&&o)$(i[t]).text("'"+o);else if($(i[t]).attr("timestamp")){var l=timestampToDate(o,a);$(i[t]).text(l)}else if($(i[t]).attr("func")){var d=window[$(i[t]).attr("func")](o);$(i[t]).text(d)}else $(i[t]).text(o)}})),a?r.find("#transaction_no").text(t):r.find("#selected_item").attr("data-no",t),r.find("#details-show-info__id__").attr("data-id",e.id),r.find("#details-show-info__id__").attr("href","tran-detail/"+e.id),e.selected?r.find("#selected_item").attr("checked",!0):r.find("#selected_item").attr("checked",!1),r.html()},this.exportExcel=function(e){e.preventDefault();for(var t=$(e.target).attr("file-name"),a=$(e.target).attr("clone-table"),n="",r=1,i=0;i<this.objJson.length;i++)this.objJson[i][1].selected&&(n+="<tr>"+this.createEL(this.objJson[i][1],r,!0,a)+"</tr>",r++);var s=document.getElementById(a).cloneNode(!0);s.querySelector("th:last-child").remove(),s.querySelector("#table-rows").innerHTML=n;var o=XLSX.utils.table_to_book(s,{sheet:"sheet1",cellDates:!1,raw:!1});return XLSX.writeFile(o,t+".xlsx")},this.printData=function(e){e.preventDefault();for(var t=$(e.target).attr("clone-table"),a="",n=1,r=0;r<this.objJson.length;r++)this.objJson[r][1].selected&&(a+="<tr>"+this.createEL(this.objJson[r][1],n,!0)+"</tr>",n++);var i=$("#"+t).clone();i.find("#table-rows").html($.parseHTML(a)),i.removeAttr("hidden"),i.find("th:last-child, td:last-child").hide();var s=window.open();s.document.write(i.prop("outerHTML")),s.print(),s.close()},fomatNumber=function(e){return(e=parseInt(e))>0||e<0?e.toLocaleString("en-US"):0},timestampToDate=function(e,t){if((e=parseInt(e))>0){var a;return t?(a=new Date(1e3*e)).getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate():a=new Date(1e3*e).toLocaleDateString("vi-VN")}return""}}var t=new e,a=$('[name="_token"]').val();function n(a){t&&(t=null),(t=new e).init(a)}n(transactions),$("#select-time").datepicker({format:"yyyy-mm",startView:"months",minViewMode:"months",autoclose:!0}).on("change",(function(e){var t={time:$("#select-time").val(),_token:a};$.ajax({type:"POST",url:getListByMonthUrl,data:t,success:function(e){console.log(e),200==e.status?(console.log(e.data),transactions=e.data.data,n(transactions),$("#total_transaction").text(e.data.totalTransaction),$("#total_paid_amount").text(e.data.totalAmount)):($("#errorModal").find(".msg_error").text(e.message),$("#errorModal").show())},error:function(e,t){0===e.status||(404==e.status||(500==e.status||("parsererror"===t||("timeout"===t||("abort"===t||e.responseText))))),$("#errorModal").show()}})})),$("#submit-data").on("click",(function(e){e.preventDefault(),$("#submit-data").prop("disabled",!0);var t=$("#search-form");t.find("input:text").each((function(){$(this).val($.trim($(this).val()))}));var a=t.attr("action");$.ajax({type:"POST",url:a,data:t.serialize(),success:function(e){var t=new bootstrap.Modal(document.getElementById("errorModal"));$.isEmptyObject(e)?(console.log("here"),$("#errorModal").find(".msg_error").text("Có lỗi xảy ra trong quá trình tìm kiếm"),t.show()):200==e.status?(console.log(e.data),transactions=e.data.data,n(transactions)):($("#errorModal").find(".msg_error").text(e.message),t.show()),$("#submit-data").prop("disabled",!1),$("#fillter-content").hide()},error:function(e,t){var a="";a=0===e.status?"Not connect.\n Verify Network.":404==e.status?"Requested page not found. [404]":500==e.status?"Internal Server Error [500].":"parsererror"===t?"Requested JSON parse failed.":"timeout"===t?"Time out error.":"abort"===t?"Ajax request aborted.":"Uncaught Error.\n"+e.responseText,$("#submit-data").prop("disabled",!1),$("#errorModal").find(".msg_error").text(a),$("#errorModal").show()}})})),$("#search-input").on("change",(function(e){e.preventDefault();var t=$("#search-input").val();console.log(t);var a=new RegExp(t,"g"),r=[];t?transactions.forEach((function(e,t){null!==JSON.stringify(e).match(a)&&r.push(e)})):r=transactions,n(r)}))}))}});