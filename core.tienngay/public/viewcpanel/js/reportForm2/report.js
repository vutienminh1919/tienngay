!function(e){var t={};function a(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=t,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(r,n,function(t){return e[t]}.bind(null,n));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/",a(a.s=12)}({12:function(e,t,a){e.exports=a(13)},13:function(e,t){$(document).ajaxStart((function(){$("#loading").show();var e=window.screen.height;$("#loading, .right-col iframe").css("height",e)})).ajaxStop((function(){$("#loading").hide()})),$(document).ready((function(){function e(){this.initData={},this.objJson={},this.current_page=1,this.records_per_page=25,this.selectedIds=[];this.init=function(e){this.initData=e;var t=Object.keys(e).map((function(t){return[Number(t),e[t]]}));this.objJson=t.sort((function(e,t){var a=e[0].ngay_thanh_toan,r=t[0].ngay_thanh_toan;return new Date(a)>new Date(r)?1:-1})),this.createPanigation(),this.changePage(1),$("#select-all").off().on("click",this.selectAll.bind(this)),$("#export-excel").off().on("click",this.exportExcel.bind(this)),$("#print-data").off().on("click",this.printData.bind(this)),document.getElementById("total").innerHTML=fomatNumber(this.objJson.length)},this.selectAll=function(e){var t=[];$(".selected_item").prop("checked",e.target.checked),this.objJson.forEach((function(a,r){a[1].selected=e.target.checked,e.target.checked&&t.push(a[1].id)})),this.selectedIds=t},this.selectItem=function(e){var t=$(e.target).attr("data-no");if(this.objJson[t][1].selected=e.target.checked,e.target.checked&&-1===this.selectedIds.indexOf(this.objJson[t][1].id))this.selectedIds.push(this.objJson[t][1].id);else{var a=this.selectedIds.indexOf(this.objJson[t][1].id);a>-1&&this.selectedIds.splice(a,1)}},this.numPages=function(){return Math.ceil(this.objJson.length/this.records_per_page)},this.prevPage=function(){this.current_page>1&&(this.current_page--,this.changePage(this.current_page))},this.nextPage=function(){this.current_page<this.numPages()&&(this.current_page++,this.changePage(this.current_page))},this.changePageAction=function(e){var t=$(e.target).attr("data-page");this.changePage(t)},this.changePage=function(e){var t=document.getElementById("btn_prev"),a=document.getElementById("btn_next"),r=document.getElementById("listingTable"),n=document.getElementById("page");e<1&&(e=1),e>this.numPages()&&(e=this.numPages()),this.current_page=e,r.innerHTML="";for(var i=(e-1)*this.records_per_page;i<e*this.records_per_page;i++)this.objJson[i]&&(r.innerHTML+=this.createEL(this.objJson[i][1],i));if(n.innerHTML=e+"/"+this.numPages(),1==e?t.classList.add("disabled"):t.classList.remove("disabled"),e==this.numPages()?a.classList.add("disabled"):a.classList.remove("disabled"),$(".page-number.active").removeClass("active"),$("[data-page="+e+"]").parent().addClass("active"),$(".selected_item").on("click",this.selectItem.bind(this)),this.numPages()>10){var o=0,s=0;this.numPages()-Number(e)<Number(5)?o=Number(e)-2*Number(5)+(this.numPages()-Number(e)):(o=Number(e)-Number(5))<1&&(o=1),Number(e)-Number(o)<Number(5)?s=Number(e)+2*Number(5)-(Number(e)-Number(o)):(s=Number(e)+Number(5))>this.numPages()&&(s=this.numPages()),$(".page-number").addClass("hide-item");for(var c=o;c<=s;c++)$("[data-page="+c+"]").parent().removeClass("hide-item"),$("[data-page="+c+"]").text($("[data-page="+c+"]").attr("data-page"));$("[data-page="+Number(o-1)+"]").parent().removeClass("hide-item"),$("[data-page="+Number(o-1)+"]").text("..."),$("[data-page="+Number(s+1)+"]").parent().removeClass("hide-item"),$("[data-page="+Number(s+1)+"]").text("...")}},this.numPages=function(){return Math.ceil(this.objJson.length/this.records_per_page)},this.createPanigation=function(){$("li.page-number").remove();for(var e=1;e<=this.numPages();e++)1==e?$("<li class='page-item page-number active'><a class='page-link' data-page='"+e+"' href='javascript:void(0);'>"+e+"</a></li>").insertBefore("#btn_next"):$("<li class='page-item page-number'><a class='page-link' data-page='"+e+"' href='javascript:void(0);'>"+e+"</a></li>").insertBefore("#btn_next");$("#btn_prev").off().on("click",this.prevPage.bind(this)),$("#btn_next").off().on("click",this.nextPage.bind(this)),$(".pagination").off().on("click",".page-number",this.changePageAction.bind(this))},this.createEL=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"clone-object",n=$("#"+r).find("#clone-item").clone(),i=n.find("td");return $.each(i,(function(t,r){var n=$(i[t]).attr("data-attr");if(n){var o=n.split("."),s=null;if(o.length>1){s=e;for(var c=0;c<o.length;c++){if(!(o[c]in s))return;s=s[o[c]]}}else{if(!(n in e))return;s=e[n]}if($(i[t]).attr("format-number"))_numberFormated=fomatNumber(s),$(i[t]).text(_numberFormated);else if($(i[t]).attr("zero-before")&&s)$(i[t]).text("'"+s);else if($(i[t]).attr("timestamp")){var l=timestampToDate(s,a);$(i[t]).text(l)}else if($(i[t]).attr("func")){var d=window[$(i[t]).attr("func")](s);$(i[t]).text(d)}else $(i[t]).text(s)}})),a?n.find("#transaction_no").text(t):n.find("#selected_item").attr("data-no",t),n.find("#details-show-info__id__").attr("data-id",e.id),n.find("#details-show-info__id__").attr("href","tran-detail/"+e.id),e.selected?n.find("#selected_item").attr("checked",!0):n.find("#selected_item").attr("checked",!1),n.html()},this.exportExcel=function(e){e.preventDefault();for(var t=$(e.target).attr("file-name"),a=$(e.target).attr("clone-table"),r="",n=1,i=0;i<this.objJson.length;i++)this.objJson[i][1].selected&&(r+="<tr>"+this.createEL(this.objJson[i][1],n,!0,a)+"</tr>",n++);var o=document.getElementById(a).cloneNode(!0);o.querySelector("th:last-child").remove(),o.querySelector("#table-rows").innerHTML=r;var s=XLSX.utils.table_to_book(o,{sheet:"sheet1",cellDates:!1,raw:!1});return XLSX.writeFile(s,t+".xlsx")},this.printData=function(e){e.preventDefault();for(var t=$(e.target).attr("clone-table"),a="",r=1,n=0;n<this.objJson.length;n++)this.objJson[n][1].selected&&(a+="<tr>"+this.createEL(this.objJson[n][1],r,!0)+"</tr>",r++);var i=$("#"+t).clone();i.find("#table-rows").html($.parseHTML(a)),i.removeAttr("hidden"),i.find("th:last-child, td:last-child").hide();var o=window.open();o.document.write(i.prop("outerHTML")),o.print(),o.close()},fomatNumber=function(e){return(e=parseInt(e))>0||e<0?e.toLocaleString("en-US"):0},timestampToDate=function(e,t){if((e=parseInt(e))>0){var a;return t?(a=new Date(1e3*e)).getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate():a=new Date(1e3*e).toLocaleDateString("vi-VN")}return""}}var t=new e,a=$('[name="_token"]').val();function r(a){t&&(t=null),(t=new e).init(a)}r(transactions),$("#select-time").datepicker({format:"yyyy-mm",startView:"months",minViewMode:"months",autoclose:!0}).on("change",(function(e){var t={time:$("#select-time").val(),_token:a};$.ajax({type:"POST",url:getListByMonthUrl,data:t,success:function(e){console.log(e),200==e.status?(console.log(e.data),transactions=e.data.data,r(transactions),$("#total_transaction").text(e.data.totalTransaction),$("#total_paid_amount").text(e.data.totalAmount)):($("#errorModal").find(".msg_error").text(e.message),$("#errorModal").show())},error:function(e,t){0===e.status||(404==e.status||(500==e.status||("parsererror"===t||("timeout"===t||("abort"===t||e.responseText))))),$("#errorModal").show()}})})),$("#submit-data").on("click",(function(e){e.preventDefault(),$("#submit-data").prop("disabled",!0);var t=$("#search-form"),a=!0;if(t.find("input:text, input:radio, select").each((function(){var e=$.trim($(this).val());$(this).val(e),""!==e&&void 0!==e&&(a=!1)})),a){var n=new bootstrap.Modal(document.getElementById("errorModal"));return $("#errorModal").find(".msg_error").text("Thông tin lọc dữ liệu đang để trống"),n.show(),$("#submit-data").prop("disabled",!1),void $("#fillter-content").hide()}var i=t.attr("action");!function(e){var t="";if(""===e||null==e);else{var a=JSON.parse('{"'+decodeURI(e).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}'),r=!0;for(var n in a)a.hasOwnProperty(n)&&"access_token"!=n&&"_token"!=n&&""!==a[n]&&void 0!==a[n]&&null!==a[n]&&(t+=r?"?"+n+"="+a[n]:"&"+n+"="+a[n],r=!1)}var i=$(document).find("title").text(),o=location.protocol+"//"+location.host+location.pathname;window.history.pushState({},i,o+t)}(t.serialize()),$.ajax({type:"POST",url:i,data:t.serialize(),success:function(e){var t=new bootstrap.Modal(document.getElementById("errorModal"));$.isEmptyObject(e)?(console.log("here"),$("#errorModal").find(".msg_error").text("Có lỗi xảy ra trong quá trình tìm kiếm"),t.show()):200==e.status?(console.log(e.data),transactions=e.data,r(transactions)):($("#errorModal").find(".msg_error").text(e.message),t.show()),$("#submit-data").prop("disabled",!1),$("#fillter-content").hide()},error:function(e,t){var a="";a=0===e.status?"Not connect.\n Verify Network.":404==e.status?"Requested page not found. [404]":500==e.status?"Internal Server Error [500].":"parsererror"===t?"Requested JSON parse failed.":"timeout"===t?"Time out error.":"abort"===t?"Ajax request aborted.":"Uncaught Error.\n"+e.responseText,$("#submit-data").prop("disabled",!1),$("#errorModal").find(".msg_error").text(a),$("#errorModal").show()}})})),$("#search-input").on("change",(function(e){e.preventDefault();var t=$("#search-input").val();console.log(t);var a=new RegExp(t,"g"),n=[];t?transactions.forEach((function(e,t){null!==JSON.stringify(e).match(a)&&n.push(e)})):n=transactions,r(n)})),function(){var e=location.search.substring(1);if(""!==e&&null!=e){var t=JSON.parse('{"'+decodeURI(e).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}'),a=!1;for(var r in t)t.hasOwnProperty(r)&&"access_token"!=r&&"_token"!=r&&""!==t[r]&&void 0!==t[r]&&null!==t[r]&&($('[name="'+r+'"').val(decodeURIComponent(t[r])),a=!0);a&&$("#submit-data").trigger("click")}}()}))}});